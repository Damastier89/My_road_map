# Date and Time

- [UTC](#utc)
- [Data](#data)

### **`UTC`**
#### Что такое UTC?
> UTC расшифровывается, как `Coordinated Universal Time` или `Координированное всемирное время`. Это стандартный международный часовой пояс, используемый для синхронизации часов в разных частях мира. UTC было введено, чтобы обеспечить точную и стандартизированную систему измерения времени, которая не зависит от местной географии или культуры.

#### В чем разница между GMT и UTC?
> GMT (Greenwich Mean Time) и UTC (Coordinated Universal Time) - это оба стандартные часовые пояса, которые используются для измерения времени. Однако, есть небольшая разница между ними.
> Ранее, GMT использовалось как стандартный временной пояс, чтобы отсчитывать время относительно Гринвича, в Лондоне. Сейчас же, UTC используется как мировой часовой пояс, и он более точный стандарт: в разнице всего лишь на 0,9 секунды, в то время как GMT основан на среднем солнечном времени.
> В общем, UTC считается более точным и унифицированным часовым поясом, а GMT - это стандарт, который все еще используется, но не является основным.

#### Что такое Unix-время?
> Unix-время (или POSIX-время) - это формат представления времени в компьютерных системах, основанных на Unix. Этот формат используется для измерения времени от начала эпохи Unix (1 января 1970 года 00:00:00 UTC), как количество секунд, прошедших с того момента времени. Unix-время используется во многих операционных системах, программных языках и приложениях для записи, хранения и передачи данных о времени и дате. Это очень удобный формат для обмена данными, потому что он является независимым от часового пояса и обеспечивает простой способ вычисления интервалов времени.

[Вернуться к началу статьи](#date-and-time)

---

### **`Data`**
#### Способы создания даты в javascript.
В JavaScript существует несколько способов создания даты.
1. Использование конструктора Date(). Можно создать новый объект Дата, вызвав конструктор:
```javascript
    let now = new Date(); // текущая дата и время
    let date = new Date('2022-01-01'); // 1 января 2022 года
```
2. Использование методов класса Date. Это позволяет установить дату и время:
```javascript
    let date = new Date();
    date.setFullYear(2022);
    date.setMonth(0);
    date.setDate(1);
```
3. Использование методов статического класса Date. Это позволяет разбить даты и время на компоненты:
```javascript
    let date = Date.parse('2022-01-01'); // количество миллисекунд с начала эпохи Unix
    let year = Date.getFullYear(date);
    let month = Date.getMonth(date);
    let day = Date.getDate(date);
```

> Однако при таком подходе необходимо учитывать время в часовом поясе клиента. Кроме того, есть также сторонние библиотеки, такие как Moment.js, которые облегчают создание и форматирование дат, особенно в сложных сценариях.

####  RFC2822/ISO 8601

> RFC 2822 и ISO 8601 - это стандарты, используемые для форматирования и представления дат и времени в электронных сообщениях, веб-приложениях и других информационных системах.

> RFC 2822 является стандартом Интернета, определяющим формат даты и времени для электронных сообщений, таких как электронная почта и сообщения новостных групп. Он определяет, каким образом дата и время должны быть представлены в сообщении, чтобы можно было эффективно обрабатывать и анализировать информацию об отправителе и времени отправки сообщения.

> ISO 8601 - это международный стандарт, определяющий универсальный способ представления даты и времени в цифровой форме. Он облегчает обмен информацией между компьютерными системами, так как использует стандартизированный формат даты и времени, что обеспечивает более эффективную обработку и сравнение информации. Он также определяет дополнительные правила и форматы, такие как часовой пояс и длительность времени.

> Использование стандартных форматов таких как RFC 2822 и ISO 8601 важно для обеспечения совместимости и правильной обработки дат и времени в разных информационных системах.

#### Преобразовать дату из формата RFC2822/ISO 8601 в Unix-время
> В JavaScript можно преобразовать дату из формата RFC2822/ISO 8601 в Unix-время с помощью метода `getTime()`. Этот метод возвращает количество миллисекунд, прошедших с начала эпохи Unix (1 января 1970 года 00:00:00 UTC) до указанной даты.
```javascript
    let dateString = '2022-01-01T00:00:00Z'; // дата в формате ISO 8601
    let unixTime = new Date(dateString).getTime() / 1000; // преобразуем дату в Unix-время
    console.log(unixTime); // 1640995200
```
> Здесь мы создаем строку с датой и временем в формате ISO 8601, затем создаем новый объект Date на основе этой строки и вызываем метод getTime(), чтобы получить количество миллисекунд. Затем мы делим это число на 1000 для получения количества секунд и сохраняем его в переменную unixTime. В результате получаем число, которое представляет дату в формате Unix-времени.

#### Получить текущие значения компонентов даты
- `Date().getFullYear()` : Возвращает текущий год (4-значное число).
- `Date().getMonth()` : Возвращает текущий месяц (от 0 до 11).
- `Date().getDate()` : Возвращает текущий день месяца (от 1 до 31).
- `Date().getDay()` : Возвращает текущий день недели (от 0 до 6, где 0 - воскресенье, 6 - суббота).
- `Date().getHours()` : Возвращает текущее значение часов (от 0 до 23).
- `Date().getMinutes()` : Возвращает текущее значение минут (от 0 до 59).
- `Date().getSeconds()` : Возвращает текущее значение секунд (от 0 до 59).
- `Date().getMilliseconds()` : Возвращает текущее значение миллисекунд (от 0 до 999).

#### Разность дат
Пример вычисления разности между двумя датами:
```javascript
    let date1 = new Date('2022-01-01');
    let date2 = new Date('2022-02-01');
    
    let differenceInMs = date2.getTime() - date1.getTime();
    
    console.log(differenceInMs); // разница в миллисекундах между двумя датами
```
> Этот код создает две объекта Date с датами 1 января 2022 года и 1 февраля 2022 года соответственно. Затем мы используем метод getTime() для получения количества миллисекунд, прошедших с начала эпохи Unix (1 января 1970 года 00:00:00 UTC) до каждой из дат. Разница между двумя значениями сохраняется в переменной differenceInMs в виде количества миллисекунд.
```javascript
    let differenceInSeconds = differenceInMs / 1000; // разница в секундах
    let differenceInMinutes = differenceInMs / (1000 * 60); // разница в минутах
    let differenceInHours = differenceInMs / (1000 * 60 * 60); // разница в часах
    let differenceInDays = differenceInMs / (1000 * 60 * 60 * 24); // разница в днях
```

#### Cпособы форматирования даты. Что такое locale?
1. Date.toISOString(): создает строковое представление даты в формате ISO, к примеру “2022-01-01T00:00:00.000Z”.
```javascript
    let date = new Date();
    let isoString = date.toISOString();
    console.log(isoString); // "2022-01-01T00:00:00.000Z"
```
2. Date.toLocaleString(): создает строковое представление даты и времени с учетом локали.
```javascript
    let date = new Date();
    let dateString = date.toLocaleString();
    console.log(dateString); // "01.01.2022, 00:00:00"
```
3. Date.toLocaleDateString(): создает строковое представление только даты с учетом локали.
```javascript
    let date = new Date();
    let dateString = date.toLocaleDateString();
    console.log(dateString); // "01.01.2022"
```
4. Date.toLocaleTimeString(): создает строковое представление только времени с учетом локали.
```javascript
    let date = new Date();
    let timeString = date.toLocaleTimeString();
    console.log(timeString); // "00:00:00"
```

> `Locale` - это параметр, используемый для форматирования даты и времени в соответствии с локальными настройками пользователя. Локаль - это набор культурных, лингвистических и географических параметров, которые определяют формат даты, времени и других данных, связанных с языком.

> Например, формат даты может быть разным для США и Европы, а формат времени может быть разным для России и Японии. Методы форматирования даты, перечисленные выше, включают локальные настройки по умолчанию. Однако, можно передать опцию локали в функцию, чтобы указать нужную локаль:
```javascript
    let date = new Date();
    let options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric', timeZone: 'UTC' };
    let dateString = date.toLocaleDateString('en-US', options);
    console.log(dateString); // "Saturday, January 1, 2022"
```

#### Cконвертировать дату в JSON.
> Для сохранения объекта даты в JSON в качестве даты, а не строки, необходимо применить функцию ревайвера, которая восстанавливает дату из строки. Рассмотрим пример:
```javascript
    const date = new Date();
    const obj = { myDate: date };
    
    // преобразовываем объект в JSON
    const json = JSON.stringify(obj, function(key, value) {
      if (value instanceof Date) {
        return { _type: 'date', value: value.getTime() };
      }
      return value;
    });
    
    console.log(json); // {"myDate":{"_type":"date","value":1641021529947}}
    
    // преобразовываем JSON обратно в объект
    const objFromJson = JSON.parse(json, function(key, value) {
      if (value && typeof value === 'object' && value._type === 'date') {
        return new Date(value.value);
      }
      return value;
    });
    
    console.log(objFromJson.myDate instanceof Date); // true
    console.log(objFromJson.myDate.toISOString()); // 2022-01-01T04:38:49.947Z
```
> В этом примере мы создаем объект даты и добавляем его в объект obj. Затем мы преобразуем объект obj в JSON с помощью функции JSON.stringify() и передаем второй аргумент, функцию ревайвера. В функции ревайвера мы проверяем, является ли значение датой, и если да, сохраняем его в формате объекта с помощью свойства ‘_type’ и значение datetime в свойстве ‘value’.

> Затем мы преобразовываем JSON обратно в объект с помощью функции JSON.parse() и снова передаем функцию ревайвера, которая восстанавливает значение даты из объекта ‘_type’.

> Обработка даты в JSON может быть полезна при обмене данными между клиентом и сервером, особенно если клиент и сервер находятся в разных часовых поясах.

[Вернуться к началу статьи](#date-and-time)

---
